{% extends "base.html" %}
{% now "Y-m-d H:i:s" as now %} <!-- RÃ©cupÃ¨re la date actuelle -->
{% block title %}Liste des emprunts{% endblock %}

{% block content %}
    <div>
        <h2>ğŸ“š Liste des emprunts</h2>
        <!-- Lien vers la liste complÃ¨te des mÃ©dias -->
        <a href="{% url 'liste_medias' %}">ğŸ“‚ Voir tous les mÃ©dias</a>
    </div>

    <table border="1">
        <tr>
            <th>ID</th>
            <th>Membre</th>
            <th>MÃ©dia EmpruntÃ©</th>
            <th>Date d'Emprunt</th>
            <th>Date de Retour</th>
            <th>Action</th>
        </tr>

        {% for emprunt in emprunts %}
        <tr>
            <td>{{ emprunt.id }}</td>
            <td>{{ emprunt.membre.nom }}</td>
            <td>
                {% if emprunt.media %}
                    {{ emprunt.media.titre }} <!-- Affiche le titre du mÃ©dia -->
                {% else %}
                     âŒ MÃ©dia introuvable
                {% endif %}
            </td>
            <td>{{ emprunt.date_emprunt|date:"d M, Y" }}</td>
            <td>
                {% if emprunt.date_retour %}
                    {{ emprunt.date_retour|date:"d M, Y H:i:s" }}
                {% else %}
                    ğŸ”¹ En attente de retour
                {% endif %}
            </td>
            <td>
                {% if not emprunt.date_retour or emprunt.date_retour > now %}
                    <a href="{% url 'retourner_media' emprunt.id %}">ğŸ”„ Retourner</a>
                {% else %}
                    <p>  âœ… DÃ©jÃ  retournÃ©</p>
                {% endif %}
            </td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="6">ğŸ“­ Aucun emprunt en cours.</td>
        </tr>
        {% endfor %}
    </table>
{% endblock %}